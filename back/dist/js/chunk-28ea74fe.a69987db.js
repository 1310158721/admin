(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28ea74fe"],{2031:function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"permission-add-page-wrapper"},[t("el-form",{ref:"form",staticClass:"permission-form",attrs:{model:e.userInfos,rules:e.rules,"label-width":"96px","label-position":"left"}},[t("el-row",{staticClass:"form-content-wrapper",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{size:"small",label:"账号：",prop:"account"}},[t("el-input",{attrs:{size:"small"},model:{value:e.userInfos.account,callback:function(s){e.$set(e.userInfos,"account",s)},expression:"userInfos.account"}})],1),t("el-form-item",{attrs:{size:"small",label:"密码：",prop:"password"}},[t("el-input",{attrs:{size:"small"},model:{value:e.userInfos.password,callback:function(s){e.$set(e.userInfos,"password",s)},expression:"userInfos.password"}})],1),t("el-form-item",{attrs:{size:"small",label:"名称：",prop:"name"}},[t("el-input",{attrs:{size:"small"},model:{value:e.userInfos.name,callback:function(s){e.$set(e.userInfos,"name",s)},expression:"userInfos.name"}})],1),t("el-form-item",{attrs:{size:"small",label:"号码：",prop:"mobile"}},[t("el-input",{attrs:{size:"small",maxlength:"11"},model:{value:e.userInfos.mobile,callback:function(s){e.$set(e.userInfos,"mobile",s)},expression:"userInfos.mobile"}})],1),t("el-form-item",{attrs:{size:"small",label:"头像：",prop:"avatar"}},[t("UploadFiles",{attrs:{action:"/api/upload",data:{directory:"avatar"}},on:{removeCallBack:e.removeCallBack,successCallback:e.successCallback}})],1),t("el-form-item",{attrs:{size:"small",label:"级别："}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.userInfos.role,callback:function(s){e.$set(e.userInfos,"role",s)},expression:"userInfos.role"}},e._l(e.roleEnum,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{size:"small",label:"描述：",prop:"desc"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:6},"show-word-limit":"",maxlength:"100",placeholder:"请输入内容"},model:{value:e.userInfos.desc,callback:function(s){e.$set(e.userInfos,"desc",s)},expression:"userInfos.desc"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{size:"small",label:"权限菜单："}},[e.menuList?t("el-tree",{ref:"tree",attrs:{data:e.menuList,"show-checkbox":"","default-expand-all":"","node-key":"permission","highlight-current":"","check-strictly":"",props:e.defaultProps},on:{check:e.checkChange}}):e._e()],1)],1)],1),t("div",{staticClass:"button-wrapper mgt-20"},[t("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(s){return e.$throttleHandleAdd("form")}}},[e._v("添加")])],1)],1)],1)},a=[],n=(t("7ae7"),t("86dd"),t("a677"),t("e90c"),t("1a8c"),t("3a20"),t("baa4"),t("3547"),t("ef8e"),t("252a"),t("93ff")),l=(t("63ff"),t("34fe")),i=t("2f14"),o=t("a206"),u=t("aaef"),c={name:"PermissionAddPage",components:{},props:{},data:function(){return{menuList:null,hasPermission:["DASHBOARD"],defaultProps:{children:"children",label:"title"},userInfos:{account:"",password:"",name:"",mobile:"",role:"COMMON",avatar:"",desc:"",permission:""},rules:{account:[{required:!0,message:"请输入用户账号"},{pattern:u["a"].ACCOUNT,message:"账号格式不正确，4～10个的字母"}],password:[{required:!0,message:"请输入用户密码"},{pattern:u["a"].PASSWORD,message:"密码格式不正确，4～10个的字母或数字组合"}],name:[{required:!0,message:"请输入用户名称"},{pattern:u["a"].USERNAME,message:"名称格式不正确，4～10个的字母或中文组合"}],mobile:[{required:!0,message:"请输入用户号码"},{pattern:u["a"].MOBILE,message:"号码格式不正确"}],avatar:[{required:!0,message:"请上传头像"}],desc:[{required:!0,message:"请输入用户相关的描述"}]}}},computed:{roleEnum:function(){return this.$store.state.userInfo.isSelf?o["a"]:o["a"].filter((function(e){return"SUPERADMIN"!==e.value}))},$throttleHandleAdd:function(){var e=this;return Object(i["c"])((function(s){return e.handleAdd(s)}),2e3)}},methods:{getAllPermissionMenu:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("/getAllPermissionMenu");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function s(){return e.apply(this,arguments)}return s}(),registerUser:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.post("/registerUser",s);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function s(s){return e.apply(this,arguments)}return s}(),checkChange:function(e,s){var t=e.permission,r=s.checkedKeys,a=r.includes(t),l=[];this.getAllChildKeys([e],l);var i=this.$refs.tree.getCheckedKeys(),o=null;if(a){var u=this.$refs.tree.getNode(t),c=u.parent,f=[];this.getAllParentKeys(c,f),o=Object(n["a"])(new Set([].concat(l,Object(n["a"])(i),f)))}else o=i.filter((function(e){return!l.includes(e)}));this.$refs.tree.setCheckedKeys(o)},getAllChildKeys:function(e){var s=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.map((function(e){t.push(e.permission),e.children&&s.getAllChildKeys(e.children,t)}))},getAllParentKeys:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Array.isArray(e.data)||s.push(e.data.permission),e.parent&&this.getAllParentKeys(e.parent,s)},handleAdd:function(e){var s=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;s.userInfos.permission=s.$refs.tree.getCheckedKeys().join(","),s.registerUser(s.userInfos).then((function(e){var t=e.data,r=t.status,a=t.msg;0===r&&(s.$message.success(a),s.$router.back())}))}))},removeCallBack:function(){this.userInfos.avatar=""},successCallback:function(e){var s=e.result,t=s.url;this.userInfos.avatar=t}},created:function(){var e=this;this.getAllPermissionMenu().then((function(s){var t=s.data,r=t.status,a=t.result;0===r&&(e.menuList=a,e.$nextTick((function(){e.$refs.tree.setCheckedKeys(e.hasPermission)})))}))},mounted:function(){},watch:{}},f=c,m=(t("e29f"),t("5511")),p=Object(m["a"])(f,r,a,!1,null,"67a14828",null);s["default"]=p.exports},aaef:function(e,s,t){"use strict";t.d(s,"a",(function(){return r}));var r={ACCOUNT:/^[a-z-A-Z]{4,10}$/,PASSWORD:/^[a-zA-Z][a-zA-Z0-9]{3,9}$/,USERNAME:/[\u4e00-\u9fa5_a-zA-Z]{3,10}$/,MOBILE:/^[1]([3-9])[0-9]{9}$/}},ad59:function(e,s,t){},e29f:function(e,s,t){"use strict";var r=t("ad59"),a=t.n(r);a.a}}]);
//# sourceMappingURL=chunk-28ea74fe.a69987db.js.map