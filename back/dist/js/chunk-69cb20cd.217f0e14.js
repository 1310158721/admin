(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69cb20cd"],{"3f36":function(e,t,s){var r=s("91fe"),n=s("f30e"),a=s("8c47"),i=s("4aef").f,o=s("7a23"),l=n((function(){i(1)})),u=!o||l;r({target:"Object",stat:!0,forced:u,sham:!o},{getOwnPropertyDescriptor:function(e,t){return i(a(e),t)}})},"4ca4":function(e,t,s){"use strict";function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s.d(t,"a",(function(){return r}))},"79dd":function(e,t,s){var r=s("91fe"),n=s("ee6f"),a=s("16e5"),i=s("f30e"),o=i((function(){a(1)}));r({target:"Object",stat:!0,forced:o},{keys:function(e){return a(n(e))}})},be5c:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"permission-edit-page-wrapper"},[s("el-form",{ref:"form",staticClass:"permission-form",attrs:{model:e.userInfos,rules:e.rules,"label-width":"96px","label-position":"left"}},[s("el-row",{staticClass:"form-content-wrapper",attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{size:"small",label:"账号："}},[s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.userInfos.account,callback:function(t){e.$set(e.userInfos,"account",t)},expression:"userInfos.account"}})],1),s("el-form-item",{attrs:{size:"small",label:"密码："}},[s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.userInfos.password,callback:function(t){e.$set(e.userInfos,"password",t)},expression:"userInfos.password"}})],1),s("el-form-item",{attrs:{size:"small",label:"名称："}},[s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.userInfos.name,callback:function(t){e.$set(e.userInfos,"name",t)},expression:"userInfos.name"}})],1),s("el-form-item",{attrs:{size:"small",label:"号码："}},[s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.userInfos.mobile,callback:function(t){e.$set(e.userInfos,"mobile",t)},expression:"userInfos.mobile"}})],1),s("el-form-item",{attrs:{size:"small",label:"创建时间："}},[s("el-input",{attrs:{size:"small",disabled:""},model:{value:e.userInfos.createdTime,callback:function(t){e.$set(e.userInfos,"createdTime",t)},expression:"userInfos.createdTime"}})],1),s("el-form-item",{attrs:{size:"small",label:"头像："}},[s("div",{directives:[{name:"viewer",rawName:"v-viewer.static",value:{inline:!1},expression:"{inline: false}",modifiers:{static:!0}}],staticClass:"images"},[s("img",{attrs:{src:e.userInfos.avatar,width:"144",height:"144"}})])]),s("el-form-item",{attrs:{size:"small",label:"级别："}},[s("el-select",{attrs:{disabled:"SUPERADMIN"===e.userInfos.role,placeholder:"请选择"},model:{value:e.userInfos.role,callback:function(t){e.$set(e.userInfos,"role",t)},expression:"userInfos.role"}},e._l(e.roleEnum,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",{attrs:{size:"small",label:"描述：",prop:"desc"}},[s("el-input",{attrs:{disabled:"",type:"textarea",autosize:{minRows:3,maxRows:6},"show-word-limit":"",maxlength:"100",placeholder:"请输入内容"},model:{value:e.userInfos.desc,callback:function(t){e.$set(e.userInfos,"desc",t)},expression:"userInfos.desc"}})],1)],1),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{size:"small",label:"权限菜单："}},[e.menuList?s("el-tree",{ref:"tree",attrs:{data:e.menuList,"show-checkbox":"","default-expand-all":"","node-key":"permission","highlight-current":"","check-strictly":"",props:e.defaultProps},on:{check:e.checkChange}}):e._e()],1)],1)],1),s("div",{staticClass:"button-wrapper mgt-20"},[s("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.$throttleHandleSave(t)}}},[e._v("保 存")])],1)],1)],1)},n=[],a=(s("4178"),s("7ae7"),s("86dd"),s("af82"),s("a677"),s("e90c"),s("1a8c"),s("3f36"),s("f4dd"),s("79dd"),s("3a20"),s("b3f9"),s("baa4"),s("3547"),s("ef8e"),s("3e5e"),s("9a14"),s("252a"),s("93ff")),i=(s("63ff"),s("34fe")),o=s("4ca4"),l=s("2f14"),u=s("a206"),c=s("08c1");function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach((function(t){Object(o["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var m={name:"PermissionEditPage",components:{},props:{},data:function(){return{isLoading:!1,id:null,userInfos:{},rules:{},menuList:null,hasPermission:null,defaultProps:{children:"children",label:"title"}}},computed:{roleEnum:function(){return"SUPERADMIN"===this.userInfos.role?u["a"]:u["a"].filter((function(e){return"SUPERADMIN"!==e.value}))},$throttleHandleSave:function(){var e=this;return Object(l["c"])((function(){return e.handleSave()}),2e3)}},methods:d({},Object(c["b"])(["SETUSERINFOS","SETMENULIST"]),{getUserInfo:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("/getUserInfos",{params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getAllPermissionMenu:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("/getAllPermissionMenu");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),updateUserPermissionInfos:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,this.$axios.post("/updateUserPermissionInfos",t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),checkChange:function(e,t){var s=e.permission,r=t.checkedKeys,n=r.includes(s),i=[];this.getAllChildKeys([e],i);var o=this.$refs.tree.getCheckedKeys(),l=null;if(n){var u=this.$refs.tree.getNode(s),c=u.parent,f=[];this.getAllParentKeys(c,f),l=Object(a["a"])(new Set([].concat(i,Object(a["a"])(o),f)))}else l=o.filter((function(e){return!i.includes(e)}));this.$refs.tree.setCheckedKeys(l)},getAllChildKeys:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.map((function(e){s.push(e.permission),e.children&&t.getAllChildKeys(e.children,s)}))},getAllParentKeys:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Array.isArray(e.data)||t.push(e.data.permission),e.parent&&this.getAllParentKeys(e.parent,t)},handleSave:function(){var e=this,t=this.$refs.tree.getCheckedKeys().join(","),s=this.userInfos.role;this.updateUserPermissionInfos({permission:t,role:s,_id:this.id}).then((function(t){var s=t.data,r=s.status,n=s.msg;0===r&&(e.userInfos.account===e.$store.state.userInfo.account&&e.userInfos.password===e.$store.state.userInfo.password?(e.isLoading=!1,e.$message.success(n),e.userInfos.isSelf?e.$router.push({name:"PermissionMenu",params:{isShouldRefresh:!0}}):e.$router.back()):(e.isLoading=!1,e.$message.success(n),e.$router.back()))}))}}),created:function(){var e=this,t=this.$route.query._id;this.id=t,this.isLoading=!0,this.$axios.all([this.getUserInfo({_id:t}),this.getAllPermissionMenu()]).then(this.$axios.spread((function(t,s){var r=s.data.status;0===r&&(e.menuList=s.data.result);var n=t.data.status;if(0===n){e.userInfos=t.data.result,e.userInfos.createdTime=Object(l["a"])(new Date(e.userInfos.createdTime),"yyyy-MM-dd hh:mm:ss");var a=e.userInfos.permission,i=void 0===a?"":a;e.hasPermission=i.split(","),e.$nextTick((function(){e.$refs.tree.setCheckedKeys(i.split(","))}))}e.isLoading=!1})))},mounted:function(){},watch:{}},p=m,h=(s("ec7a"),s("5511")),b=Object(h["a"])(p,r,n,!1,null,"966057e6",null);t["default"]=b.exports},d74f:function(e,t,s){},ec7a:function(e,t,s){"use strict";var r=s("d74f"),n=s.n(r);n.a},f4dd:function(e,t,s){var r=s("91fe"),n=s("7a23"),a=s("e628"),i=s("8c47"),o=s("4aef"),l=s("01d7");r({target:"Object",stat:!0,sham:!n},{getOwnPropertyDescriptors:function(e){var t,s,r=i(e),n=o.f,u=a(r),c={},f=0;while(u.length>f)s=n(r,t=u[f++]),void 0!==s&&l(c,t,s);return c}})}}]);
//# sourceMappingURL=chunk-69cb20cd.217f0e14.js.map